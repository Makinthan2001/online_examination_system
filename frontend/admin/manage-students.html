<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Manage Students</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body class="bg-gray-50 min-h-screen">
  <div class="flex min-h-screen">
    <!-- Sidebar (inline, not iframe) -->
    <nav class="sidebar bg-white border-r" aria-label="Main Navigation" style="width:220px; min-width:220px; height:100vh; display:flex; flex-direction:column;">
      <div class="sidebar-header font-bold text-2xl px-6 py-4 border-b">Online Exam</div>
      <ul class="sidebar-menu flex-1 px-0 py-4" style="list-style:none; margin:0;">
        <li tabindex="0" role="menuitem" aria-label="Dashboard" class="px-6 py-3 flex items-center gap-3 cursor-pointer hover:bg-indigo-100 rounded transition" onclick="location.href='admin-dashboard.html'">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="none"><path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z" fill="#64748b"/></svg>
          <span>Dashboard</span>
        </li>
        <!-- <li tabindex="0" role="menuitem" aria-label="Add Question" class="px-6 py-3 flex items-center gap-3 cursor-pointer hover:bg-indigo-100 rounded transition" onclick="location.href='add-question.html'">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="none"><path d="M12 4v16m8-8H4" stroke="#64748b" stroke-width="2"/></svg>
          <span>Add Question</span>
        </li> -->
        <li tabindex="0" role="menuitem" aria-label="Add Student" class="px-6 py-3 flex items-center gap-3 cursor-pointer hover:bg-indigo-100 rounded transition" onclick="location.href='add-student.html'">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="none"><circle cx="12" cy="7" r="4" stroke="#64748b" stroke-width="2"/><path d="M5.5 21a6.5 6.5 0 0 1 13 0" stroke="#64748b" stroke-width="2"/></svg>
          <span>Add Student</span>
        </li>
        <li tabindex="0" role="menuitem" aria-label="Manage Students" class="px-6 py-3 flex items-center gap-3 cursor-pointer hover:bg-indigo-100 rounded transition" onclick="location.href='manage-students.html'">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="none"><path d="M4 4h16v2H4zm0 4h10v2H4zm0 4h16v2H4zm0 4h10v2H4z" fill="#64748b"/></svg>
          <span>Manage Students</span>
        </li>
        <li tabindex="0" role="menuitem" aria-label="Create Exam" class="px-6 py-3 flex items-center gap-3 cursor-pointer hover:bg-indigo-100 rounded transition" onclick="location.href='create-exam.html'">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="none"><path d="M19 3H5a2 2 0 0 0-2 2v14l4-4h12a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z" stroke="#64748b" stroke-width="2"/></svg>
          <span>Create Exam</span>
        </li>
        <li tabindex="0" role="menuitem" aria-label="Manage Exams" class="px-6 py-3 flex items-center gap-3 cursor-pointer hover:bg-indigo-100 rounded transition" onclick="location.href='manage-exams.html'">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="none"><path d="M5 13l4 4L19 7" stroke="#64748b" stroke-width="2"/></svg>
          <span>Manage Exams</span>
        </li>
        <li tabindex="0" role="menuitem" aria-label="Result" class="px-6 py-3 flex items-center gap-3 cursor-pointer hover:bg-indigo-100 rounded transition" onclick="location.href='result.html'">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="none"><path d="M3 17a4 4 0 0 0 4 4h10a4 4 0 0 0 4-4V7a4 4 0 0 0-4-4H7a4 4 0 0 0-4 4v10z" stroke="#64748b" stroke-width="2"/><path d="M8 11h8M8 15h6" stroke="#64748b" stroke-width="2"/></svg>
          <span>Result</span>
        </li>
      </ul>
      <div class="px-6 pb-6 mt-auto">
        <button onclick="logout()" class="w-full text-sm bg-red-100 text-red-600 px-3 py-2 rounded">Logout</button>
      </div>
    </nav>

    <!-- Main Content -->
    <div class="flex-1">
      <!-- Navbar -->
      <nav class="bg-white shadow p-4 mb-6">
        <div class="container mx-auto text-xl font-bold">Manage Students</div>
      </nav>
      <div class="container mx-auto px-4 py-8">
    <!-- Header -->
    <div class="flex justify-between items-center mb-8">
      
      <button onclick="location.href='add-student.html'" class="flex items-center bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
        <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor"><use href="#plus"/></svg>
        Add Student
      </button>
    </div>

    <!-- Search -->
    <div class="bg-white rounded shadow p-4 mb-6">
      <div class="flex items-center space-x-2">
        <svg class="h-4 w-4 text-gray-400"><use href="#search"/></svg>
        <input id="searchInput" type="text" placeholder="Search students by name or username..." class="border border-gray-300 rounded px-3 py-2 w-full max-w-sm"/>
      </div>
    </div>

    <!-- Student Table -->
    <div class="bg-white rounded shadow">
      <div class="p-4 flex items-center space-x-2">
        <svg class="h-5 w-5 text-gray-600"><use href="#users"/></svg>
        <h2 class="text-lg font-semibold">Student List (<span id="studentCount">0</span>)</h2>
      </div>
      <div class="p-4 overflow-x-auto">
        <table class="w-full">
          <thead>
            <tr class="border-b text-left text-gray-600">
              <th class="py-2 px-4">Username</th>
              <th class="py-2 px-4">Name</th>
              <th class="py-2 px-4">Age</th>
              <th class="py-2 px-4">Status</th>
              <th class="py-2 px-4 text-right">Actions</th>
            </tr>
          </thead>
          <tbody id="studentTableBody"></tbody>
        </table>

        <!-- Empty State -->
        <div id="emptyState" class="text-center py-10 hidden">
          <svg class="h-12 w-12 text-gray-400 mx-auto mb-4"><use href="#users"/></svg>
          <h3 class="text-lg font-semibold mb-2" id="emptyTitle">No students registered</h3>
          <p class="text-gray-500 mb-4" id="emptySub">Get started by adding your first student</p>
          <button onclick="location.href='add-student.html'" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
            <svg class="h-4 w-4 inline-block mr-1" fill="none" stroke="currentColor"><use href="#plus"/></svg>
            Add First Student
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Icons -->
  <svg style="display: none;">
    <symbol id="plus" viewBox="0 0 24 24"><path d="M12 5v14m7-7H5"/></symbol>
    <symbol id="edit" viewBox="0 0 24 24"><path d="M11 4H6a2 2 0 00-2 2v12a2 2 0 002 2h12a2 2 0 002-2v-5"/></symbol>
    <symbol id="trash" viewBox="0 0 24 24"><path d="M3 6h18M8 6v14M16 6v14M5 6l1-2h12l1 2"/></symbol>
    <symbol id="search" viewBox="0 0 24 24"><path d="M21 21l-4.35-4.35M11 19a8 8 0 100-16 8 8 0 000 16z"/></symbol>
    <symbol id="users" viewBox="0 0 24 24"><path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2M9 7a4 4 0 110-8 4 4 0 010 8zM23 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75"/></symbol>
  </svg>

  <script>
    const searchInput = document.getElementById('searchInput');
    const studentTableBody = document.getElementById('studentTableBody');
    const studentCount = document.getElementById('studentCount');
    const emptyState = document.getElementById('emptyState');
    const emptyTitle = document.getElementById('emptyTitle');
    const emptySub = document.getElementById('emptySub');

    function getStudents() {
      const allUsers = JSON.parse(localStorage.getItem('users') || '[]');
      return allUsers.filter(user => user.role === 'student');
    }

    function deleteStudent(username) {
      if (!confirm('Are you sure you want to delete this student?')) return;
      let users = JSON.parse(localStorage.getItem('users') || '[]');
      users = users.filter(u => u.username !== username);
      localStorage.setItem('users', JSON.stringify(users));
      renderStudents();
      alert('Student deleted successfully.');
    }

    function renderStudents() {
      const term = searchInput.value.toLowerCase();
      const students = getStudents().filter(s =>
        s.username.toLowerCase().includes(term) ||
        (s.name && s.name.toLowerCase().includes(term))
      );

      studentTableBody.innerHTML = '';
      studentCount.textContent = students.length;

      if (students.length === 0) {
        emptyState.classList.remove('hidden');
        if (term) {
          emptyTitle.textContent = 'No students found';
          emptySub.textContent = 'Try adjusting your search criteria';
        } else {
          emptyTitle.textContent = 'No students registered';
          emptySub.textContent = 'Get started by adding your first student';
        }
        return;
      } else {
        emptyState.classList.add('hidden');
      }

      students.forEach(student => {
        const row = document.createElement('tr');
        row.className = 'border-b hover:bg-gray-100';
        row.innerHTML = `
          <td class="py-2 px-4 font-medium">${student.username}</td>
          <td class="py-2 px-4">${student.name || 'N/A'}</td>
          <td class="py-2 px-4">${student.age || 'N/A'}</td>
          <td class="py-2 px-4"><span class="text-green-600 text-sm border border-green-600 px-2 py-0.5 rounded">Active</span></td>
          <td class="py-2 px-4 text-right">
            <div class="flex justify-end space-x-2">
              <button onclick="location.href='edit-student.html?username=${student.username}'" class="p-1 border rounded hover:bg-gray-200">
                <svg class="h-4 w-4 text-gray-600"><use href="#edit"/></svg>
              </button>
              <button onclick="deleteStudent('${student.username}')" class="p-1 border rounded hover:bg-red-100 text-red-600">
                <svg class="h-4 w-4"><use href="#trash"/></svg>
              </button>
            </div>
          </td>
        `;
        studentTableBody.appendChild(row);
      });
    }

    searchInput.addEventListener('input', renderStudents);

    // Optional: Mock data for testing
    if (!localStorage.getItem('users')) {
      localStorage.setItem('users', JSON.stringify([
        { username: 'john123', name: 'John Doe', age: 20, role: 'student' },
        { username: 'jane456', name: 'Jane Smith', age: 22, role: 'student' }
      ]));
    }

    renderStudents();
  </script>
</body>
</html>
